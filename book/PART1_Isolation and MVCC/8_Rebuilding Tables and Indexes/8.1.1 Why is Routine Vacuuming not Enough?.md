정기적 vacuuming은 page pruning보다 더 많은 공간을 회수할 수 있지만, 그것만으로는 부족할 수 있다.

만약 테이블이나 인덱스의 파일의 크기가 커지면, VACUUM은 페이지 내에서 일부 공간을 정리할 수 있지만, 페이지 수를 줄이는 경우는 거의 없다.
회수된 공간은 파일의 끝 부분에 빈 페이지들이 연속적으로 나타낼 때에만 운영체제로 반환되며, 자주 발생하지 않는다.

과도한 크기는 여러 부정적 결과를 초래한다 :
- 테이블(인덱스) 풀스캔이 오래걸림.
- 더 큰 버퍼 캐시가 필요함(페이지가 통으로 캐시됨 -> 데이터 밀집성 감소)
- B-tree가 추가 레벨을 가질 수 있음 -> 인덱스 접근 속도 느려짐
- 디스크와 백업 공간 감소

만약 파일에 있는 유용한 데이터의 비율이 합리적인 레벨로 떨어지면, 관리자는 `VACUUM FULL` 명령어를 실행하여 전체 vacuuming을 수행할 수 있다.
이 경우에, 테이블과 모든 인덱스가 처음부터 재구성되며, 데이터를 가능한 한 밀집되게 저장한다(이때 fillfactor 파라미터도 고려된다).

full vacuuming이 실행되면, PostgreSQL은 먼저 테이블을 완전히 재구성한 후, 그 인덱스들을 각각 재구성한다. 
재구성 과정에서, 이전 파일과 새로 생성된 파일이 동시에 디스크에 저장되므로 [^1] 디스크에 충분한 여유 공간이 필요하다.

또한, 이 작업 동안 테이블에 대한 읽기 및 쓰기 작업이 완전히 차단된다는 점도 유의해야 한다!


[^1]:postgresql.org/docs/current/routine-vacuuming.html#VACUUM-FOR-SPACE-RECOVERY
[^2]:backend/commands/cluster.c