
백엔드가 더티 페이지를 버퍼에서 evict할 경우, 페이지를 디스크에 기록해야 한다. 이러한 상황을 바람직하지 않은데, 이는 대기 시간을 유발하기 때문이다-대신 백그라운드에서 비동기적으로 쓰기 작업을 수행하는 것이 훨씬 좋다.

이 작업은 부분적으로 *checkpointer*에 의해 처리되지만, 이는 충분하지 않다.

따라서, PostgreSQL은 bgwritter[^1] 라는 또 다른 프로세스를 제공하여 백그라운드에서 쓰기 작업을 처리한다. 이 프로세스는 eviction과 동일한 버퍼 탐색 알고리즘을 사용하지만, 2가지 차이점이 있다 :

- bgwriter 프로세스는 자기만의 시계바늘을 사용하며, 이는 퇴출 알고리즘의 시계바늘보다 항상 뒤쳐지지 않고 일반적으로 앞에 있다.
- 버퍼를 탐색하는 동안 사용 횟수는 감소되지 않는다.

dirty 페이지는 버퍼가 pinned되지 않았고, usage count가 0일때 플러시된다.
따라서 bgwriter는 evcition 전에 실행되어, 퇴출될 가능성이 높은 페이지를 디스크에 기록한다.

이러면 퇴출될 버퍼들이 깨끗한 상태일 확률이 높아진다.


[^1]:backend/postmaster/bgwriter.c