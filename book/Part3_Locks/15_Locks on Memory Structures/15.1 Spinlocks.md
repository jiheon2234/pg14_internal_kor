공유 메모리에서 데이터 구조를 보호하기 위해, PostgreSQL은 일반적인 *heavyweight locks* 대신 여러 종류의 더 가볍고 비용이 적은 락들을 사용한다.

가장  간단한 잠금은 *spinlock*이다. 이들은 보통 아주 짧은 시간 동안 (몇 cpu 사이클)획득되며, 특정 메모리 셀을 동시 업데이트로부터 보호하는 데 사용된다.

스핀락은 *compare-and-swap* [^1] 같은 automic cpu 연산을 기반으로 한다. 이들은 오직 베타적 잠금만 지원한다.
만약 필요로 하는 자원이 잠겨있을 경우, 프로세스는 명령을 반복하면서 바쁘게 대기한다(이건 루프에서 "spin"하는데, 이름의 유래이다).
만약 지정된 시간 내에 잠금을 획득하지 못하면, 프로세스는 잠시 일시 정지한 후 다시 루프를 시작한다.

이 전략은 충돌 가능성이 매우 낮다고 예상될 때 유효하다. 따라서 잠금을 얻지 못해도, 잠금은 몇 개의 명령어 내에서 획득될 가능성이 높다.

스핀락은 데드락 감지나 계측 도구를 제공하지 않는다. 실용적인 관점에서, 우리는 그들의 존재에 대해서만 알고 있으면 된다; 이들의 올바른 구현에 대한 책임인 PostgreSQL 개발자에게 있다.






[^1]:[backend/storage/lmgr/s_lock.c](https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/storage/lmgr/s_lock.c;hb=REL_14_STABLE)